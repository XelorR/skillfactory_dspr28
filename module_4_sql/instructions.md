# Инструкции

## ЗАДАЧА

Напомним, что вам предстоит выяснить, от каких самых малоприбыльных рейсов из Анапы мы можем отказаться в зимнее время. Вы не знаете, по каким критериям ваше руководство будет отбирать рейсы, поэтому решаете собрать как можно больше информации, содержащейся в вашей базе, в один датасет. 

Исходя из того, что прибыльность рейса — это разница между доходом от продаж билетов и расходом на полет, соберите такой датасет, который позволит оценить эти цифры. 

Самая простая модель оценки прибыльности: стоимость билетов - стоимость топлива на рейс (для оценки последнего вам необходим километраж рейса или длительность полета), но вы можете предложить другую модель.

Ваш датасет должен обязательно включать id рейса и города вылета (Анапа) и прилета. Он также  может включать такие данные, как модель самолёта и его характеристики, суммарную стоимость всех билетов на рейсе, затраченное время в полёте и прочее — на ваше усмотрение.

	Важно! Не все данные, необходимые для решения задачи, есть в вашей базе. Соберите всё, что есть — остальное дополнят специалисты, которые будут проводить анализ.

## ПРЕЗЕНТАЦИЯ

Помимо датасета и кода с решением вам нужно подготовить презентацию на 5-6 слайдов, которую вы будете использовать для защиты своего решения перед центральным офисом. Презентация должна содержать:

1. Структуру вашего датасета.
2. Описание данных и их отношение к оценке прибыльности.
3. Данные, которые можно добавить в вашу таблицу, но вы не нашли их в базе данных.
4. Возможные способы оценки прибыльности рейсов на основе вашего датасета.

## Чтобы получить необходимую предварительную информацию о рейсах, выполните запрос:

```sql
SELECT *
FROM dst_project.flights
WHERE departure_airport = 'AAQ'
  AND (date_trunc('month', scheduled_departure) in ('2017-01-01','2017-02-01', '2017-12-01'))
  AND status not in ('Cancelled')
```